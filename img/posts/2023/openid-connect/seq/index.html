<p>actor Resource Owner<br>participant Client<br>participant Authorization Server</p><p>Resource Owner->Client: click login link<br>Resource Owner&lt;--Client: redirect to authorization ep<br>Resource Owner->Authorization Server: access authorization ep<br>Resource Owner&lt;->Authorization Server: authenticate<br>Resource Owner->Authorization Server: authorize<br>Resource Owner&lt;--Authorization Server: grant code & redirect to client<br>Resource Owner->Client: access with code<br>Client->Authorization Server: token ep with code<br>Client&lt;-Authorization Server: <strong>(A)</strong> token<br>Client->Protected Resource: access resource with token<br>Client&lt;-Protected Resource: <strong>(B)</strong> resource</p><p>==</p><p>actor End User<br>participant Relying Party<br>participant OpenID Provider</p><p>End User->Relying Party: click login link<br>End User&lt;--Relying Party: redirect to authorization ep<br>End User->OpenID Provider: access authorization ep<br>End User&lt;->OpenID Provider: authenticate<br>End User->OpenID Provider: authorize<br>End User&lt;--OpenID Provider: grant code & redirect to Relying Party<br>End User->Relying Party: access with code<br>Relying Party->OpenID Provider: token ep with code<br>Relying Party&lt;-OpenID Provider: <strong>(A)</strong> access token & ID token<br>Relying Party->OpenID Provider: <strong>(B)</strong> access UserInfo with access token<br>Relying Party&lt;-OpenID Provider: <strong>(C)</strong> UserInfo</p><p>==</p><p>actor End User<br>participant Relying Party<br>participant OpenID Provider</p><p>End User->Relying Party: click login link<br>End User&lt;--Relying Party: redirect to authorization ep<br>End User->OpenID Provider: access authorization ep<br>End User&lt;->OpenID Provider: authenticate<br>End User->OpenID Provider: authorize<br>End User&lt;--OpenID Provider: grant code & redirect to Relying Party<br>End User->Relying Party: access with code<br>Relying Party->OpenID Provider: token ep with code<br>Relying Party&lt;-OpenID Provider: <strong>(A)</strong> access token & ID token<br>Relying Party->OpenID Provider: <strong>(B)</strong> access UserInfo with access token<br>Relying Party&lt;-OpenID Provider: <strong>(C)</strong> UserInfo</p><p>==</p><p>actor End User<br>participant Relying Party<br>participant OpenID Provider</p><p>End User->Relying Party: GET /localhost:8080/login<br>End User&lt;--Relying Party: 302 Location /accounts.google.com/o/oauth2/auth<br>End User->OpenID Provider: GET /accounts.google.com/o/oauth2/auth<br>End User&lt;->OpenID Provider: authenticate<br>End User->OpenID Provider: authorize<br>End User&lt;--OpenID Provider: 302 Location /localhost:8080/callback<br>End User->Relying Party: GET /localhost:8080/callback<br>Relying Party->OpenID Provider: POST /oauth2.googleapis.com/token<br>Relying Party&lt;-OpenID Provider: 200, access token & ID token<br>Relying Party->OpenID Provider: GET /openidconnect.googleapis.com/v1/userinfo<br>Relying Party&lt;-OpenID Provider: 200, userinfo<br>End User&lt;-Relying Party:302 Location /localhost:8080</p>